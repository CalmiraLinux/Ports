<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
	<title>1.1. О дистрибутиве Calmira GNU/Linux</title>
</head>
<link rel="stylesheet" href="/usr/share/update-ports/css/styles.css">
<body style="margin: 0px 150px 0px 150px">

<h1>Configuring ISC DHCP</h1>

<h2>Config files</h2>

<p><tt>/etc/dhcp/dhclient.conf</tt> and <tt>/etc/dhcp/dhcpd.conf</tt></p>

<h2>Client configuration</h2>

<p>Create a basic <tt>/etc/dhcp/dhclient.conf</tt> by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
install -vdm755 /etc/dhcp &&
cat > /etc/dhcp/dhclient.conf << "EOF"
# Begin /etc/dhcp/dhclient.conf
#
# Basic dhclient.conf(5)

#prepend domain-name-servers 127.0.0.1;
request subnet-mask, broadcast-address, time-offset, routers,
        domain-name, domain-name-servers, domain-search, host-name,
        netbios-name-servers, netbios-scope, interface-mtu,
        ntp-servers;
require subnet-mask, domain-name-servers;
#timeout 60;
#retry 60;
#reboot 10;
#select-timeout 5;
#initial-interval 2;

# End /etc/dhcp/dhclient.conf
EOF
</pre></td></tr></table>

<p>See <b><tt>dhclient.conf (5)</b></tt> man page for additional options</p>

<p>Now create the <tt>/var/lib/dhclient</tt> directory which will contain DHCP Client leases by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
install -v -dm 755 /var/lib/dhclient
</pre></td></tr></table>

<p>At this point you can test if <b><tt>dhclient</tt></b> is behaving as expected by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
dhclient &lt;eth0&gt;
</pre></td></tr></table>

<p>Replace <tt>&lt;eth0&gt;</tt> with your desired interface. If you want more verbose output, add the <b><tt>-v</tt></b> parameter to the command above.</p>

<p>If you want to configure network interfaces at boot using dhclient, you need to install the <tt>/lib/services/dhclient</tt> script included in the <a href="https://github.com/CalmiraLinux/calm-bootscripts">calm-bootscripts</a> package. For installation, see the Calmira documentation page (internet) or <a href="/usr/share/doc/Calmira/setup/bootscripts.html">local documentation</a>.</p>

<p>Next, create the <tt>/etc/sysconfig/ifconfig.eth0</tt> configuration file with the following commands as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
cat > /etc/sysconfig/ifconfig.eth0 << "EOF"
ONBOOT="yes"
IFACE="eth0"
SERVICE="dhclient"
DHCP_START=""
DHCP_STOP=""

# Set PRINTIP="yes" to have the script print
# the DHCP assigned IP address
PRINTIP="no"

# Set PRINTALL="yes" to print the DHCP assigned values for
# IP, SM, DG, and 1st NS. This requires PRINTIP="yes".
PRINTALL="no"
EOF
</pre></td></tr></table>

<p>Adjust the file to suit your needs.  For more information on the appropriate <tt>DHCP_START</tt> and <tt>DHCP_STOP</tt> values see <tt>dhclient (8)</tt> man page.</p>

<h2>Server configuration</h2>

<p>Note that you only need the DHCP server if you want to issue LAN addresses over your network. The DHCP client doesn't need the server in order to function properly.</p>

<p>Start with creating <tt>/etc/dhcp/dhcpd.conf</tt> by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
cat > /etc/dhcp/dhcpd.conf << "EOF"
# Begin /etc/dhcp/dhcpd.conf
#
# Example dhcpd.conf(5)

# Use this to enable / disable dynamic dns updates globally.
ddns-update-style none;

# option definitions common to all supported networks...
option domain-name "example.org";
option domain-name-servers ns1.example.org, ns2.example.org;

default-lease-time 600;
max-lease-time 7200;

# This is a very basic subnet declaration.
subnet 10.254.239.0 netmask 255.255.255.224 {
  range 10.254.239.10 10.254.239.20;
  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;
}

# End /etc/dhcp/dhcpd.conf
EOF
</pre></td></tr></table>

<p>Adjust the file to suit your needs. See <tt>dhcpd.conf (5)</tt> man page for additional options.</p>

<p>Now create the <tt>/var/lib/dhcpd</tt> directory which will contain DHCP Server leases by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
install -v -dm 755 /var/lib/dhcpd
</pre></td></tr></table>

<p>If you want to start the DHCP Server at boot, install the <tt>/etc/rc.d/init.d/dhcpd</tt> init script included in the <a href="https://github.com/CalmiraLinux/calm-bootscripts">calm-bootscripts</a> package. For installation, see the Calmira documentation page (internet) or <a href="/usr/share/doc/Calmira/setup/bootscripts.html">local documentation</a>.</p>

<p>You will need to edit the <tt>/etc/sysconfig/dhcpd</tt> in order to set the interface on which <b><tt>dhcpd</tt></b> will serve the DHCP requests.</p>

</body></html>
