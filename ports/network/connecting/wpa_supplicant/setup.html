<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
	<title>Configuring wpa_supplicant</title>
</head>
<link rel="stylesheet" href="/usr/share/update-ports/css/styles.css">
<body style="margin: 0px 150px 0px 150px">

<h1>Configuring wpa_supplicant</h1><hr>

<h2>Config file</h2>

<p><tt>/etc/sysconfig/wpa_supplicant-*.conf</tt></p>

<h2>Configuration information</h2>

<p>To connect to an access point that uses a password, you need to put the pre-shared key in <tt>/etc/sysconfig/wpa_supplicant-wifi0.conf</tt>. SSID is the string that the access point/router transmits to identify itself. Run the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
wpa_passphrase SSID SECRET_PASSWORD > /etc/sysconfig/wpa_supplicant-wifi0.conf
</pre></td></tr></table>

<p><tt>/etc/sysconfig/wpa_supplicant-wifi0.conf</tt> can hold the details of several access points. When <b><tt>wpa_supplicant</tt></b> is started, it will scan for the SSIDs it can see and choose the appropriate password to connect.</p>

<p>If you want to connect to an access point that isn't password protected, put an entry like this in <tt>/etc/sysconfig/wpa_supplicant-wifi0.conf</tt>. Replace "Some-SSID" with the SSID of the access point/router.</p>

<table border="1" width="100%" cellpadding="5">
<tr><td>
<pre>
network={
  ssid="<em>Some-SSID</em>"
  key_mgmt=NONE
}
</pre></td></tr></table>

<p>Connecting to a new access point that is not in the configuration file can be accomplished manually via the command line or GUI, but it must be done via a privileged user. To do that, add the following to the configuration file:</p>

<table border="1" width="100%" cellpadding="5">
<tr><td>
<pre>
ctrl_interface=DIR=/run/wpa_supplicant GROUP=&lt;privileged group&gt;
update_config=1
</pre></td></tr></table>

<p>Replace the &lt;privileged group&gt; above with a system group where members have the ability to connect to a wireless access point.</p>

<p>There are many options that you could use to tweak how you connect to each access point. They are described in some detail in the <tt>wpa_supplicant/wpa_supplicant.conf</tt> file in the source tree.</p>

<h2>Connecting to an Access Point</h2>

<p>If you want to configure network interfaces at boot using wpa_supplicant, you need to install the <tt>/lib/services/wpa</tt> script included in <a href="https://github.com/CalmiraLinux/calm-bootscripts">calm-bootscripts</a> package. For installation this scripts, see the Calmira documentation page (internet) or <a href="/usr/share/doc/Calmira/setup/bootscripts.html">local documentation</a>.</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
make install-service-wpa
</pre></td></tr></table>

<p>If your router/access point uses DHCP to allocate IP addresses, you can install DHCP-4.4.2 (<tt>network/connecting/DHCP</tt> port) client and use it to automatically obtain network addresses. Create the <tt>/etc/sysconfig/ifconfig-wifi0</tt> by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
cat > /etc/sysconfig/ifconfig.wifi0 << "EOF"
ONBOOT="yes"
IFACE="wlan0"
SERVICE="wpa"

# Additional arguments to wpa_supplicant
WPA_ARGS=""

WPA_SERVICE="dhclient"
DHCP_START=""
DHCP_STOP=""

# Set PRINTIP="yes" to have the script print
# the DHCP assigned IP address
PRINTIP="no"

# Set PRINTALL="yes" to print the DHCP assigned values for
# IP, SM, DG, and 1st NS. This requires PRINTIP="yes".
PRINTALL="no"
EOF
</pre></td></tr></table>

<p>If you prefer <tt>dhcpcd-9.1.4</tt> instead of <tt>DHCP-4.4.2</tt> client, then create the <tt>/etc/sysconfig/ifconfig-wifi0</tt> by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
cat > /etc/sysconfig/ifconfig.wifi0 << "EOF"
ONBOOT="yes"
IFACE="wlan0"
SERVICE="wpa"

# Additional arguments to wpa_supplicant
WPA_ARGS=""

WPA_SERVICE="dhcpcd"
DHCP_START="-b -q &lt;insert appropriate start options here&gt;"
DHCP_STOP="-k &lt;insert additional stop options here&gt;"
EOF
</pre></td></tr></table>

<p>Alternatively, if you use static addresses on your local network, then create the <tt>/etc/sysconfig/ifconfig-wifi0</tt> by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
cat > /etc/sysconfig/ifconfig.wifi0 << "EOF"
ONBOOT="yes"
IFACE="wlan0"
SERVICE="wpa"

# Additional arguments to wpa_supplicant
WPA_ARGS=""

WPA_SERVICE="ipv4-static"
IP="192.168.1.1"
GATEWAY="192.168.1.2"
PREFIX="24"
BROADCAST="192.168.1.255"
EOF
</pre></td></tr></table>

<p>You can connect to the wireless access point by running the following command as the <tt>root</tt> user:</p>

<table border="1" width="100%" cellpadding="5"><colgroup>
	<col style="background-color:#eeddcc">
</colgroup>
<tr><td>
<pre>
ifup <em>wifi0</em>
</pre></td></tr></table>

<p>Replace <em><tt>wlan0</tt></em> with the correct wireless interface and <em><tt>wifi0</tt></em> with desired name for the configuration file. Please note that <tt>wpa_supplicant-*.conf</tt> and <tt>ifconfig.*</tt> configuration files need to have identical names, ie both contain <em><tt>wifi0</tt></em> in their name.</p>

<p><blockquote>From <a href="https://linuxfromscratch.org/blfs/view/10.0/basicnet/wpa_supplicant.html">BLFS</a> instruction.</blockquote></p>

</body></html>
